---
title: 'Mini Project 1: Get Ur Gait On'
bibliography: BIOL5380.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">


## Introduction
Our first Miniproject explores several topics in the biomechanical basis of terrestrial locomotion. In particular, we'll focus on how well the inverted pendulum model applies in predicting the maximum speed of walking humans and to what extent some kinematic variables, like pelvic tilt, contribute to differences in speed. We'll also look at how these kinematic variables vary by size and sex. Our general goals are to:

+ Use imageJ to perform kinematic analysis
+ Use simple mathematical models to predict maximum limb walking speed
+ Test predictions of walking speed with measurements and observations
+ Evaluate the effects of sex and size (scaling!) on your observations


```{r pend,echo=F,fig.cap=c("The inverted pendulum model of bipedal locomotion"),fig.align = 'center'}
knitr::include_graphics(c("pend.png"))
``` 


### Conceptual basis
As we've learned, the inverted pendulum (IP) is rather simple model for understanding how we walk. Under the IP model, the leg forms the radius of an arc through which your center of mass (COM) travels. Thus, we can use concepts surrounding centripetal forces to estimate how fast we walk. So far, we've ignored air resistance and the inertial effects of other moving parts (e.g., arms) and assumed the leg is rigid and rotates about the ground at a single point of contact. Under these conditions, we can make predictions as to the maximum linear velocity of our COM. The force associated with this swinging pendulum can be described as

$$
F =ma_c=\frac {mv^2}{R} 
$$

where $a_c$ the acceleration due to gravity and $R$ is the leg length, or the radius of the inverted pendulum. From this we see that the maximum velocity of the rotating mass is never greater than the square root of the product of gravity and the radius, or, in biomechanical terms 

$$
v_{max}^2 \leq gl
$$

$$
v_{max} \leq\sqrt{ gl}
$$

where $g$ is gravity and $l$ the leg length. Thus, as we have learned in class, the Froude efficiency for walking is:

$$
Fr =\frac {v^2}{gL}<=1 
$$
 
where $v$ and any realized walking velocity is less than or equal to $v_{max}$, or $gL$.

As has become clear in our class discussions and demonstrations, the characteristic length of the pendulum (i.e., the radius) is the leg length and any increase in this length will result in a greater velocity. In addition, any biomechanical mechanism that increases the leg length during otherwise lower phases of the arc (e.g., lateral pelvic tilt, that is lifting the plant-leg side of the pelvis, \autoref{fig:tilt}) will keep the COM higher and increase the velocity.


```{r tilt,echo=F,fig.cap=c("A walker tilting its pelvis"),fig.align = 'center'}
knitr::include_graphics(c("pelvictilt.jpg"))
``` 

 

## Methods

There are two parts to this MP: (1) predicting and testing predictions of maximum walking speed and (2) an analysis of pelvic tilt as it varies between normal walking at comfortable speeds and fast speeds. For both parts of this MP, it is important that you walk and not run. That means a duty factor of >0.5, i.e., you'll always have a foot on the ground. Lab partners, police your colleagues to ensure this.

### Sofware essentials

We'll need a few pieces of software to analyze the kinematics of walking. First, [download and install FIJI](https://imagej.net/software/fiji/), a free image analysis package (FIJI is just imageJ) that just about everyone in the natural sciences uses at one point in their career. Second, enable the MTrackJ plugin by following these [directions](https://imagej.net/libs/imagescience) MTrackJ is a simple tracking routine that allows users to track points across video frames.

We'll be working with video data captured with our phones. The file types associated with videos shot by phones are often unworkable in imageJ/FIJI. We need a way of converting your phone videos to AVI format, a file type that imageJ can open. Videos can be rendered into AVI files using---you guessed it---using R. See below



### Max out your pendulum

For this part of the MP you will compare a predicted maximum walking velocity ($v_{max}$) to observed maximum walking speed. First things first: mark off a distance of 5 meters on level ground (e.g., in the hall, atrium, etc.).

With your knees locked and your hands by your side and not swinging, walk on your heels as fast as you can across the the marked distance. Concentrate on not using any movement in your pelvis or knees. This may require some practice. You may, if you're careful, have a lab partner push you gently to get you going at the start of the 5-m field. With a phone or watch, record the time it takes to traverse the 5-m distance. 

Using these data, compute the velocity (in m s$^{-1}$) and compare this to your calculated $v_{max}$ based on theory. Please enter these data [**HERE**](https://docs.google.com/spreadsheets/d/13_dIyeWHcFt_7bKkLkgFhfY0IRjRBRmlI9y5xj2Juhc/edit?usp=sharing). They can be accessed here for later analysis as well.

### Full-tilt walking

The radius of your rotating mass can be effectively increased by subtle changes in posture, including active alterations in pelvic position. Lateral pelvic tilt is one such mechanism and the angle of tilt can be measured using ImageJ. While pelvic tilt results in a lengthening of the plant-leg, there are other postural consequences. 

Start with donning the markers and the yardstick with markers attached at its end as in the figure below. Attach one small marker low on the front of your shin. Attach the yardstick with binder clips to your pantwaist. Be sure that the yard stick rests right above your anterior superior illiac spines (those bony points on the front of your hip). This apparatus will amplify your pelvic motions and make data recording much easier. Have a project partner record video (in normal video mode) of your walk as you walk toward them over the 5-m course from the earlier experiment. Be careful that the full width of the yardstick in the frame at all times. You'll perform two trials per partner: (1) walking normally at a comfortable speed and (2) walking normally but as quickly as possible. For both trials, use ImageJ and the MTrackJ plugin to track the markers on your body. From these data, you should compute pelvic tilt angle (i.e. the difference between the maximum and minimum tilt angle). Please also enter these data [here](https://docs.google.com/spreadsheets/d/13_dIyeWHcFt_7bKkLkgFhfY0IRjRBRmlI9y5xj2Juhc/edit?usp=sharing). Remember, these data can be accessed for analysis from this directory. Also notice there are data from previous iterations of the class. Be sure to use all of these in your analysis.

To analyze your videos in ImageJ, you'll need to convert them to and AVI file and have the MtrackJ plugin installed (see below). Once the AVI file is stored in a directory, open it with ImageJ (File$\rightarrow$ Import $\rightarrow$ AVI . . .). Launch the MTrackJ plugin (Plugins $\rightarrow$ MtrackJ) and follow the directions from the online [manual](http://www.imagescience.org/meijering/software/mtrackj/quickstart/). The goal here is to track four positions and calculate your two kinematic values: pelvic tilt and leg angle.

### Converting Videos

We need a way of converting our phone videos into a format readable by FIJI/imageJ. The AVI format is essentially a stack of raw images that is readable by almost any software. So let's convert our videos to AVI. Fortunately, R can do that for us if we have the `av` package installed.

```{r, eval=FALSE}
library(av)

#set your working directory
setwd("some_directory")

#list files ending in MOV, the format stored by iphones

f <- list.files(full.names = T,pattern=".MOV")

#create a place to store images
dir.create("images")

#for each file, f, breakup the .MOV into the images and build avi files
for(i in f){
  if(dir.exists("images")) unlink("images",recursive = T)

  #extract images
  av_video_images(i,destdir ="images",format="tiff")
  
  #list images
  f.i <- list.files("images",full.names = T)
  
  #make the avi from the images from the MOV
  av_encode_video(f.i,gsub("MOV","avi",basename(i)),codec = "rawvideo")
}

```




```{r walk,echo=F,fig.cap=c("You lookin' all marked and stuff"),fig.align = 'center'}
knitr::include_graphics(c("walkfront.png"))
``` 



## What to address in the report

1. How did class-wide $v_{max}$ (the theoretical velocity) compare to actual class-wide pendulum-type walking speed? Were any patterns related to this revealed by calculating the Froude number?
2. How does actual pendulum walking speed vary with human size and sex? 
<!-- for future . . . How does actual recorded maximum pendulum walking speed ($v_{max}$) vary with human size and sex?  -->
3. How does pelvic tilt change with increased normal walking speeds. What is the biomechanical basis for this?
4. Does pelvic tilt at comfortable normal walking speeds vary with human size (i.e., mass and height) and sex? 

**NOTE:** Make sure you enter your data as soon as possible  [here](https://docs.google.com/spreadsheets/d/13_dIyeWHcFt_7bKkLkgFhfY0IRjRBRmlI9y5xj2Juhc/edit?usp=sharing). Be sure to use all of these data from past classes in your analysis. 



## References